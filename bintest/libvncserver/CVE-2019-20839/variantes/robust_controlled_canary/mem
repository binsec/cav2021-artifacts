gs_base<32> := [0xf7f00000, 0xf7ff0000]u;

controlled canary<32>;

@[gs_base<32>+20<32>, 4] := canary<32>;
esp<32> := [0xfff00000, 0xfff80000]u;
esp<32> := esp<32> & 0xffffFF00;
DF<1> := 0<1>;

controlled input<1280>;

path<32> := [0x8a000000, 0x8b000000]u;
path<32> := path<32> & 0xffffFF00;
@[path<32>, 160] := input<1280>;

@[esp<32>-160<32>, 160] := uninitialized_stack<1280>;
@[esp<32>+4<32>, 4] := path<32>;
@[esp<32>, 4] := original_return_address<32>;


# rfbClientErr := noop log handler
@[0x0871b6cc, 4] := 0x083eec8b;
