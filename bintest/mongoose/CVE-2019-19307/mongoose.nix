{stdenv, lib}: stdenv.mkDerivation {
    name = "mongoose";
    src = fetchTarball {
        url = "https://github.com/cesanta/mongoose/archive/6.16.tar.gz";
        sha256 = "1pi59h6dwsibmpi6pqgw2vdi7bncplk5smxiiqaf0y09kvj3fpai";
    };
    preBuild = ''
        cd examples/mqtt_broker/
    '';
    installPhase = ''
        install -Dt $out/bin mqtt_broker
    '';
    dontStrip = true;
}
